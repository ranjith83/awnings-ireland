/* ══════════════════════════════════════════════════════════════════════════════
   FOLLOW-UPS SCREEN  –  redesigned for enquiry-based timer
   Style matches the rest of the app (email-task aesthetic)
══════════════════════════════════════════════════════════════════════════════ */

.followups-container {
  padding: 20px;
  background: #f5f5f5;
  min-height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* ── Alerts ── */
.alert {
  padding: 12px 16px;
  border-radius: 6px;
  margin-bottom: 16px;
  font-size: 14px;
  animation: slideDown .3s ease-out;
}
.alert-success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
.alert-error   { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-8px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ══════════════════════════════════════════════════════════════
   HEADER
══════════════════════════════════════════════════════════════ */
.header-section {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 16px;
  background: white;
  border-radius: 8px;
  padding: 18px 24px;
  margin-bottom: 16px;
  box-shadow: 0 2px 4px rgba(0,0,0,.08);
  flex-wrap: wrap;
}

.page-title {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 20px;
  font-weight: 700;
  color: #1a1a1a;
  margin: 0 0 4px;
}
.page-title svg { color: #5a9fd4; }

.badge-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 24px;
  padding: 0 7px;
  background: #ef4444;
  color: white;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 700;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50%       { transform: scale(1.07); }
}

.page-subtitle {
  font-size: 13px;
  color: #6b7280;
  margin: 0;
  max-width: 560px;
  line-height: 1.5;
}

.header-actions { display: flex; gap: 10px; align-items: center; }

.btn-toggle,
.btn-refresh {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all .2s;
  border: 1px solid #d1d5db;
  background: white;
  color: #374151;
}
.btn-toggle:hover   { background: #f3f4f6; }
.btn-toggle.active  { background: #5a9fd4; color: white; border-color: #5a9fd4; }
.btn-refresh:hover:not(:disabled) { background: #f3f4f6; }
.btn-refresh:disabled { opacity: .5; cursor: not-allowed; }

@keyframes spin { to { transform: rotate(360deg); } }
.spinning { animation: spin .7s linear infinite; }

/* ══════════════════════════════════════════════════════════════
   CONTENT SPLIT — table + preview panel
══════════════════════════════════════════════════════════════ */
.content-split {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
  transition: grid-template-columns .25s ease;
}
.content-split.has-preview {
  grid-template-columns: 1fr 320px;
}

/* ══════════════════════════════════════════════════════════════
   TABLE CARD
══════════════════════════════════════════════════════════════ */
.table-card {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,.08);
  overflow: hidden;
}

.state-overlay {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 60px 20px;
  color: #6b7280;
  gap: 12px;
}
.spinner {
  width: 36px; height: 36px;
  border: 4px solid #e5e7eb;
  border-top-color: #5a9fd4;
  border-radius: 50%;
  animation: spin .8s linear infinite;
}

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 72px 20px;
  color: #6b7280;
  gap: 10px;
  text-align: center;
}
.empty-state svg { color: #d1d5db; }
.empty-state h3  { font-size: 18px; color: #4b5563; margin: 0; }
.empty-state p   { font-size: 13px; color: #9ca3af; margin: 0; max-width: 340px; }

/* ── Table ── */
.followups-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}

.followups-table thead tr {
  background: #f9fafb;
  border-bottom: 2px solid #e5e7eb;
}

.followups-table th {
  padding: 10px 16px;
  text-align: left;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .04em;
  color: #6b7280;
  white-space: nowrap;
}

.followup-row {
  border-bottom: 1px solid #f3f4f6;
  transition: background .12s;
}

/* Active (non-dismissed) rows are clickable */
.active-row {
  cursor: pointer;
}
.active-row:hover {
  background: #f0f7ff;
}
.preview-active {
  background: #e8f4fd !important;
  border-left: 3px solid #5a9fd4;
}

.dismissed-row {
  opacity: .5;
  cursor: default;
}
.dismissed-row:hover { background: #fafafa; }

.followups-table td { padding: 13px 16px; vertical-align: middle; }

/* Column widths */
.col-company  { width: 180px; }
.col-email    { width: 180px; }
.col-comments { }
.col-date     { width: 130px; white-space: nowrap; }
.col-overdue  { width: 110px; text-align: center; }
.col-actions  { width: 220px; white-space: nowrap; }

/* ── Company cell ── */
.company-cell {
  display: flex;
  align-items: center;
  gap: 9px;
}
.company-avatar {
  flex-shrink: 0;
  width: 32px; height: 32px;
  border-radius: 50%;
  background: linear-gradient(135deg, #5a9fd4, #4a8fc4);
  color: white;
  font-size: 13px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
}
.company-name { font-weight: 600; color: #111827; }

/* ── Email ── */
.email-addr { color: #374151; font-size: 12px; }

/* ── Comments preview ── */
.comments-preview {
  display: block;
  color: #6b7280;
  font-size: 12px;
  line-height: 1.45;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 260px;
}

/* ── Date ── */
.date-text { font-size: 12px; color: #6b7280; }

/* ── Overdue badges ── */
.overdue-badge {
  display: inline-block;
  padding: 3px 9px;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 700;
  text-align: center;
}
.overdue-warn     { background: #fef3c7; color: #92400e; }
.overdue-critical { background: #fee2e2; color: #991b1b; }

.dismissed-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 600;
  /* default — overridden by modifier classes below */
  background: #d1fae5;
  color: #065f46;
}

/* Replied — green: customer received a reply */
.dismissed-chip.chip-replied {
  background: #d1fae5;
  color: #065f46;
}

/* Quote Raised — blue: a quote was created */
.dismissed-chip.chip-quote {
  background: #dbeafe;
  color: #1e40af;
}

/* User Dismiss — amber: manually closed without action */
.dismissed-chip.chip-user {
  background: #fef3c7;
  color: #92400e;
}

/* ── Action buttons ── */
.action-row {
  display: flex;
  gap: 6px;
  align-items: center;
}

.btn-act {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 5px 10px;
  border-radius: 5px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  border: 1px solid transparent;
  transition: all .15s;
  line-height: 1;
}
.btn-act:disabled { opacity: .4; cursor: not-allowed; }

.btn-open {
  background: #eff6ff; color: #2563eb; border-color: #bfdbfe;
}
.btn-open:hover { background: #2563eb; color: white; border-color: #2563eb; transform: translateY(-1px); }

.btn-dismiss {
  background: #fff7ed; color: #ea580c; border-color: #fed7aa;
}
.btn-dismiss:hover { background: #ea580c; color: white; border-color: #ea580c; transform: translateY(-1px); }

.resolved-info { font-size: 11px; color: #9ca3af; white-space: nowrap; }

/* ══════════════════════════════════════════════════════════════
   PREVIEW PANEL
══════════════════════════════════════════════════════════════ */
.preview-panel {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,.1);
  padding: 20px;
  height: fit-content;
  position: sticky;
  top: 20px;
  animation: slideInRight .2s ease-out;
}

@keyframes slideInRight {
  from { opacity: 0; transform: translateX(16px); }
  to   { opacity: 1; transform: translateX(0); }
}

.preview-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
}
.preview-title { font-size: 14px; font-weight: 700; color: #111827; margin: 0; }
.preview-close {
  background: none; border: none; color: #9ca3af; cursor: pointer;
  padding: 2px; display: flex; align-items: center; border-radius: 4px;
  transition: color .15s, background .15s;
}
.preview-close:hover { color: #374151; background: #f3f4f6; }

.preview-section {
  margin-bottom: 14px;
}
.preview-section--full { margin-bottom: 18px; }

.preview-label {
  display: block;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .06em;
  color: #9ca3af;
  margin-bottom: 4px;
}
.preview-value { font-size: 13px; color: #374151; }
.preview-email { color: #2563eb; word-break: break-all; }

.preview-company {
  display: flex;
  align-items: center;
  gap: 8px;
}
.preview-avatar {
  width: 28px; height: 28px;
  border-radius: 50%;
  background: linear-gradient(135deg, #5a9fd4, #4a8fc4);
  color: white;
  font-size: 12px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}
.preview-company strong { font-size: 14px; color: #111827; }

.preview-comments {
  font-size: 13px;
  color: #374151;
  line-height: 1.55;
  white-space: pre-line;
  max-height: 160px;
  overflow-y: auto;
  background: #f9fafb;
  border-radius: 6px;
  padding: 10px 12px;
  border: 1px solid #e5e7eb;
}

/* Hint inside preview panel */
.preview-hint {
  display: flex;
  align-items: flex-start;
  gap: 7px;
  padding: 9px 11px;
  background: #fffbeb;
  border: 1px solid #fde68a;
  border-radius: 6px;
  font-size: 12px;
  color: #92400e;
  line-height: 1.5;
}
.preview-hint svg { color: #d97706; flex-shrink: 0; margin-top: 1px; }

.btn-preview-cta {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 7px;
  padding: 10px;
  background: #2563eb;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: background .15s, transform .1s;
  margin-top: 4px;
}
.btn-preview-cta:hover { background: #1d4ed8; transform: translateY(-1px); }

/* ══════════════════════════════════════════════════════════════
   DISMISS MODAL
══════════════════════════════════════════════════════════════ */
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.45);
  backdrop-filter: blur(2px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: fadeIn .18s ease-out;
}
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.modal-card {
  background: white;
  border-radius: 12px;
  box-shadow: 0 24px 64px rgba(0,0,0,.18);
  width: 100%;
  max-width: 490px;
  overflow: hidden;
  animation: slideUp .2s ease-out;
}
@keyframes slideUp {
  from { opacity: 0; transform: translateY(16px); }
  to   { opacity: 1; transform: translateY(0); }
}

.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px 24px;
  border-bottom: 1px solid #e5e7eb;
}
.modal-title {
  font-size: 15px;
  font-weight: 600;
  color: #111827;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}
.modal-title svg { color: #ea580c; }

.modal-close {
  background: none; border: none; color: #9ca3af; cursor: pointer;
  padding: 4px; border-radius: 4px;
  display: flex; align-items: center;
  transition: color .15s, background .15s;
}
.modal-close:hover { color: #374151; background: #f3f4f6; }

.modal-body  { padding: 22px 24px 18px; }
.modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 14px 24px;
  background: #f9fafb;
  border-top: 1px solid #e5e7eb;
}

/* Dismiss info block */
.dismiss-info {
  background: #f8fafc;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  padding: 12px 14px;
  margin-bottom: 14px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}
.dismiss-info-row {
  display: flex;
  gap: 8px;
  font-size: 13px;
  align-items: center;
}
.dismiss-label { color: #6b7280; font-weight: 500; min-width: 64px; }

/* Hint */
.modal-hint {
  display: flex;
  gap: 8px;
  align-items: flex-start;
  padding: 10px 12px;
  background: #fffbeb;
  border: 1px solid #fde68a;
  border-radius: 6px;
  font-size: 12px;
  color: #92400e;
  line-height: 1.5;
  margin-bottom: 14px;
}
.modal-hint svg { color: #d97706; flex-shrink: 0; margin-top: 1px; }

.modal-field  { margin-bottom: 0; }
.modal-label  { display: block; font-size: 13px; font-weight: 500; color: #374151; margin-bottom: 6px; }
.optional     { color: #9ca3af; font-size: 12px; }

.modal-textarea {
  width: 100%;
  padding: 9px 13px;
  border: 1px solid #d1d5db;
  border-radius: 6px;
  font-size: 14px;
  color: #111827;
  resize: vertical;
  min-height: 72px;
  box-sizing: border-box;
  font-family: inherit;
  background: white;
  transition: border-color .2s, box-shadow .2s;
}
.modal-textarea:focus {
  outline: none;
  border-color: #5a9fd4;
  box-shadow: 0 0 0 3px rgba(90,159,212,.12);
}

.btn-modal {
  padding: 8px 20px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  border: 1px solid transparent;
  transition: background .15s, transform .1s;
  min-width: 80px;
}
.btn-modal:disabled { opacity: .5; cursor: not-allowed; transform: none !important; }

.btn-cancel {
  background: white; color: #374151; border-color: #d1d5db;
}
.btn-cancel:hover:not(:disabled) { background: #f3f4f6; border-color: #9ca3af; }

.btn-confirm {
  background: #ea580c; color: white; min-width: 160px;
  display: inline-flex; align-items: center; justify-content: center;
}
.btn-confirm:hover:not(:disabled) { background: #c2410c; transform: translateY(-1px); }

/* ── Added: View button in actions column ───────────────────────── */
.btn-view-detail {
  display:inline-flex; align-items:center; gap:4px;
  padding:4px 9px; border-radius:5px; font-size:11.5px; font-weight:500;
  cursor:pointer; border:1px solid #bfdbfe; background:#eff6ff; color:#1d4ed8;
  transition:background .15s, color .15s;
}
.btn-view-detail:hover { background:#1d4ed8; color:white; border-color:#1d4ed8; }

/* ── Added: View Email Details button in hover panel ────────────── */
.btn-view-email {
  display:inline-flex; align-items:center; gap:6px;
  padding:7px 16px; border-radius:6px; font-size:13px; font-weight:500;
  cursor:pointer; border:1px solid #bfdbfe; background:#eff6ff; color:#1d4ed8;
  transition:background .15s, color .15s; width:100%;
}
.btn-view-email:hover { background:#1d4ed8; color:white; border-color:#1d4ed8; }

/* ── Added: email preview modal styles ──────────────────────────── */
.modal-card--lg { max-width:680px; }

.enquiry-meta-grid {
  display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:16px;
}
.enquiry-meta-item {
  display:flex; flex-direction:column; gap:3px;
  background:#f8fafc; border:1px solid #e5e7eb;
  border-radius:6px; padding:9px 12px;
}
.meta-label {
  font-size:11px; font-weight:600; color:#9ca3af;
  text-transform:uppercase; letter-spacing:.4px;
}
.meta-value { font-size:13px; color:#111827; font-weight:500; word-break:break-word; }
.meta-email { color:#2563eb; }

.enquiry-body-box { border:1px solid #e5e7eb; border-radius:6px; overflow:hidden; }
.enquiry-body-label {
  font-size:11px; font-weight:600; color:#9ca3af; text-transform:uppercase;
  letter-spacing:.4px; margin:0; padding:8px 12px;
  background:#f8fafc; border-bottom:1px solid #e5e7eb;
}
.enquiry-body-content {
  padding:14px; font-size:13.5px; color:#374151; line-height:1.65;
  max-height:340px; overflow-y:auto; word-break:break-word;
}

/* btn-modal additions (if not already present in follow-up CSS) */
.modal-card { background:white; border-radius:12px; box-shadow:0 24px 64px rgba(0,0,0,.18);
  width:100%; max-width:520px; overflow:hidden; animation:slideUp .2s ease-out; }
.modal-header { display:flex; align-items:center; justify-content:space-between;
  padding:16px 22px; border-bottom:1px solid #e5e7eb; }
.modal-title { display:flex; align-items:center; gap:8px; font-size:15px; font-weight:600;
  color:#111827; margin:0; }
.modal-close { background:none; border:none; color:#9ca3af; cursor:pointer; padding:4px;
  border-radius:4px; display:flex; align-items:center; }
.modal-close:hover { color:#374151; background:#f3f4f6; }
.modal-body { padding:20px 22px 16px; max-height:65vh; overflow-y:auto; }
.modal-footer { display:flex; justify-content:flex-end; gap:10px;
  padding:12px 22px; background:#f9fafb; border-top:1px solid #e5e7eb; }
.btn-modal { display:inline-flex; align-items:center; gap:5px; padding:8px 20px;
  border-radius:6px; font-size:14px; font-weight:500; cursor:pointer; border:1px solid transparent;
  transition:background .15s, transform .1s; min-width:80px; justify-content:center; }
.btn-modal-secondary { background:white; color:#374151; border-color:#d1d5db; }
.btn-modal-secondary:hover { background:#f3f4f6; }
.btn-modal-primary { background:#5a9fd4; color:white; border-color:#5a9fd4; }
.btn-modal-primary:hover { background:#4a8fc4; transform:translateY(-1px); }

@keyframes slideUp { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }
.modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,.45); backdrop-filter:blur(2px);
  display:flex; align-items:center; justify-content:center; z-index:1000; }

/* ── Responsive ── */
@media (max-width: 900px) {
  .content-split.has-preview { grid-template-columns: 1fr; }
  .preview-panel             { position: static; }
}
@media (max-width: 640px) {
  .followups-container { padding: 12px; }
  .header-section      { flex-direction: column; }
  .table-card          { overflow-x: auto; }
  .followups-table     { min-width: 740px; }
  .modal-card          { max-width: calc(100vw - 24px); }
}


/* ── Main split: always a 2-column grid ──────────────────────── */
.content-split {
  display: grid;
  /* Table always gets remaining space; panel slot is always 280px */
  grid-template-columns: 1fr 280px;
  gap: 16px;
  align-items: start;
  /* Prevent the grid from collapsing when panel is absent */
  min-height: 0;
}

/* When panel is absent (*ngIf removes it), hold the column with a ghost */
.content-split::after {
  content: '';
  display: block;
  /* Fills the grid's second column when the panel isn't rendered,
     preventing the table from expanding and causing a jump */
  width: 280px;
  grid-column: 2;
  /* Only present when panel is NOT showing */
}

/* When the real panel IS rendered, the ::after ghost is displaced
   (it sits behind the panel in the same grid cell — no extra space needed) */
.content-split.has-preview::after {
  display: none;
}

/* ── Preview panel: fixed width, no layout impact ────────────── */
.preview-panel {
  width: 280px;
  /* Stick to top of viewport as user scrolls */
  position: sticky;
  top: 80px;
  /* Smooth appear, no jump */
  animation: panelFadeIn 0.15s ease-out;
  /* Prevent panel from causing column resize */
  min-width: 0;
  flex-shrink: 0;
}

/* ── Table card: don't let it grow into panel space ─────────────*/
.table-card {
  min-width: 0;
  overflow: hidden;
}

@keyframes panelFadeIn {
  from { opacity: 0; transform: translateX(8px); }
  to   { opacity: 1; transform: translateX(0); }
}

/* ── Mobile: stack, no panel column reserved ─────────────────── */
@media (max-width: 900px) {
  .content-split,
  .content-split.has-preview {
    grid-template-columns: 1fr;
  }
  .content-split::after { display: none; }
  .preview-panel {
    width: 100%;
    position: static;
  }
}