<!-- customer.component.html -->
<div class="customer-container">
  <div class="page-header">
    <h2 class="page-title">Customer Details</h2>
    <button class="btn-add" (click)="openAddModal()">
      <i class="icon-plus"></i> Add Customer
    </button>
  </div>

  <div class="search-section">
    <h3 class="search-title">Search</h3>
    <div class="search-filters">
      <input 
        type="text" 
        placeholder="Company Name" 
        [(ngModel)]="searchFilters.companyName"
        (ngModelChange)="onSearchChange()"
        class="search-input"
      />
      <input 
        type="text" 
        placeholder="Contact" 
        [(ngModel)]="searchFilters.contact"
        (ngModelChange)="onSearchChange()"
        class="search-input"
      />
      <input 
        type="text" 
        placeholder="Mobile" 
        [(ngModel)]="searchFilters.mobile"
        (ngModelChange)="onSearchChange()"
        class="search-input"
      />
      <input 
        type="text" 
        placeholder="Email" 
        [(ngModel)]="searchFilters.email"
        (ngModelChange)="onSearchChange()"
        class="search-input"
      />
      <input 
        type="text" 
        placeholder="Site Address" 
        [(ngModel)]="searchFilters.siteAddress"
        (ngModelChange)="onSearchChange()"
        class="search-input"
      />
    </div>
  </div>

  <div class="table-container">
    <table class="customer-table">
      <thead>
        <tr>
          <th>COMPANY NAME</th>
          <th>CONTACT</th>
          <th>MOBILE</th>
          <th>EMAIL</th>
          <th>SITE ADDRESS</th>
          <th>ACTIONS</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let customer of filteredCustomers" class="clickable-row" (click)="navigateToWorkflow(customer)">
          <td>{{ customer.companyName }}</td>
          <td>{{ customer.contact }}</td>
          <td>{{ customer.mobile }}</td>
          <td>{{ customer.email }}</td>
          <td>{{ customer.siteAddress }}</td>
          <td (click)="$event.stopPropagation()">
            <button 
              class="btn-edit" 
              (click)="openEditModal(customer)"
              title="Edit Customer"
            >
              Edit
            </button>
          </td>
        </tr>
        <tr *ngIf="filteredCustomers.length === 0">
          <td colspan="6" class="no-data">No customers found</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ modalMode === 'add' ? 'Add Customer' : 'Edit Customer' }}</h2>
        <button class="btn-close" (click)="closeModal()">
          <i class="icon-close"></i>
        </button>
      </div>

      <form [formGroup]="customerForm" (ngSubmit)="onSubmit()">
        <div class="modal-body">
          <div class="form-group">
            <label for="companyName">Company Name <span class="required">*</span></label>
            <input 
              type="text" 
              id="companyName"
              formControlName="companyName"
              class="form-control"
              [class.error]="customerForm.get('companyName')?.touched && customerForm.get('companyName')?.invalid"
              placeholder="Enter company name"
            />
            <span class="error-message" *ngIf="getError('companyName')">
              {{ getError('companyName') }}
            </span>
          </div>

          <div class="form-group">
            <label for="contact">Contact <span class="required">*</span></label>
            <input 
              type="text" 
              id="contact"
              formControlName="contact"
              class="form-control"
              [class.error]="customerForm.get('contact')?.touched && customerForm.get('contact')?.invalid"
              placeholder="Enter contact name"
            />
            <span class="error-message" *ngIf="getError('contact')">
              {{ getError('contact') }}
            </span>
          </div>

          <div class="form-group">
            <label for="mobile">Mobile <span class="required">*</span></label>
            <input 
              type="text" 
              id="mobile"
              formControlName="mobile"
              class="form-control"
              [class.error]="customerForm.get('mobile')?.touched && customerForm.get('mobile')?.invalid"
              placeholder="Enter mobile number"
              maxlength="10"
            />
            <span class="error-message" *ngIf="getError('mobile')">
              {{ getError('mobile') }}
            </span>
          </div>

          <div class="form-group">
            <label for="email">Email <span class="required">*</span></label>
            <input 
              type="email" 
              id="email"
              formControlName="email"
              class="form-control"
              [class.error]="customerForm.get('email')?.touched && customerForm.get('email')?.invalid"
              placeholder="Enter email address"
            />
            <span class="error-message" *ngIf="getError('email')">
              {{ getError('email') }}
            </span>
          </div>

          <div class="form-group">
            <label for="siteAddress">Site Address <span class="required">*</span></label>
            <textarea 
              id="siteAddress"
              formControlName="siteAddress"
              class="form-control"
              [class.error]="customerForm.get('siteAddress')?.touched && customerForm.get('siteAddress')?.invalid"
              placeholder="Enter site address"
              rows="3"
            ></textarea>
            <span class="error-message" *ngIf="getError('siteAddress')">
              {{ getError('siteAddress') }}
            </span>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn-cancel" (click)="closeModal()">
            Cancel
          </button>
          <button type="submit" class="btn-submit">
            {{ modalMode === 'add' ? 'Add Customer' : 'Update Customer' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>